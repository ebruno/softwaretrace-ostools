lint:
  stage: lint
  parallel:
    matrix:
      - RUNNER_TAG: [redhat,debian]
  script:
    - |
       make -C system_management lint_all;
  allow_failure:
    exit_codes:
      - 1

  tags:
     - $RUNNER_TAG

  rules:
    - if: $CI_PIPELINE_SOURCE == "push"
    - if: $CI_PIPELINE_SOURCE == "merge_request_event"
    - if: $CI_PIPELINE_SOURCE == "schedule"
    - changes:
         - .gitlab-ci.yml
         - .gitlab-ci/lint.yml
         - ./**/Makefile
         - spec/**/*_spec.sh
         - lib/**/*.sh
